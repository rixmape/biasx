<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Models - BiasX Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Models";
        var mkdocs_page_input_path = "api/models.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> BiasX Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../getting_started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../configuration/">Configuration</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../analyzer/">Analyzer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../datasets/">Datasets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../explainers/">Explainers</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Models</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#biasx.models.Model">Model</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#biasx.models.Model.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#biasx.models.Model.predict">predict</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../calculators/">Calculators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utils/">Utilities</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">BiasX Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">Models</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="models">Models</h1>
<p>This module handles the loading and prediction using face classification models.</p>
<hr />


<div class="doc doc-object doc-class">



<h2 id="biasx.models.Model" class="doc doc-heading">
            <code>biasx.models.Model</code>


</h2>


    <div class="doc doc-contents first">


        <p>Handles loading and inference for facial classification models.</p>
<p>This class loads a Keras model from a specified path, handles batching
and preprocessing of input images, performs inference, and processes
the model's output probabilities into classified gender labels and
confidence scores. It accounts for potentially inverted class labels.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="tensorflow.keras.Model">Model</span></code>)
              –
              <div class="doc-md-description">
                <p>The loaded Keras model instance.</p>
              </div>
            </li>
            <li>
              <b><code>inverted_classes</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>If True, swaps the interpretation of the model's
output classes (e.g., if the model outputs 0 for female and 1 for
male, setting this to True maps 0 to MALE and 1 to FEMALE).</p>
              </div>
            </li>
            <li>
              <b><code>batch_size</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The batch size to use during model prediction
(<code>model.predict</code>).</p>
              </div>
            </li>
            <li>
              <b><code>_metadata</code></b>
                  (<code><span title="typing.Any">Any</span></code>)
              –
              <div class="doc-md-description">
                <p>Placeholder for potential future metadata storage.
             Currently initialized to None and not used.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="biasx.models.Model.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">inverted_classes</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the classification model handler.</p>
<p>Loads the Keras model from the given file path and stores configuration
parameters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>path</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The file path to the saved Keras model (.h5 or SavedModel dir).</p>
              </div>
            </li>
            <li>
              <b><code>inverted_classes</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>Whether the model's output classes (0 and 1)
should be interpreted in reverse order compared to the <code>Gender</code> enum
(MALE=0, FEMALE=1).</p>
              </div>
            </li>
            <li>
              <b><code>batch_size</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The batch size to use when calling <code>model.predict</code>.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments passed via configuration.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="biasx.models.Model.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">preprocessed_images</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Make gender predictions from preprocessed images.</p>
<p>This is the main public method for getting predictions. It orchestrates
the process:</p>
<ol>
<li>Prepares the input images using <code>_prepare_input</code>.</li>
<li>Gets raw probabilities from the model using <code>_get_probabilities</code>.</li>
<li>Processes these probabilities into gender labels and confidences
   using <code>_process_predictions</code>.</li>
</ol>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>preprocessed_images</code></b>
                  (<code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing.List">List</span>[<span title="numpy.ndarray">ndarray</span>]]</code>)
              –
              <div class="doc-md-description">
                <p>A single
preprocessed image, a list of images, or a batch of images
(NumPy arrays).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="biasx.types.Gender" href="../types/#biasx.types.Gender">Gender</a>, <span title="float">float</span>]]</code>
              –
              <div class="doc-md-description">
                <p>A list of tuples, one for each input image. Each tuple contains:
- predicted_gender (biasx.types.Gender): The predicted gender.
- confidence (float): The prediction confidence.</p>
              </div>
            </li>
            <li>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="biasx.types.Gender" href="../types/#biasx.types.Gender">Gender</a>, <span title="float">float</span>]]</code>
              –
              <div class="doc-md-description">
                <p>Returns an empty list if the input is empty.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../explainers/" class="btn btn-neutral float-left" title="Explainers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../calculators/" class="btn btn-neutral float-right" title="Calculators">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../explainers/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../calculators/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

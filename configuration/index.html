<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Configuration - BiasX Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Configuration";
        var mkdocs_page_input_path = "configuration.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> BiasX Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Configuration</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configuration-structure">Configuration Structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#component-configuration-details">Component Configuration Details</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#dataset-dataset">Dataset (dataset)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#model-model">Model (model)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#explainer-explainer">Explainer (explainer)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#calculator-calculator">Calculator (calculator)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#analyzer-analyzer">Analyzer (analyzer)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-configuration-file-configyaml">Example Configuration File (config.yaml)</a>
    </li>
    </ul>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../api/analyzer/">Analyzer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/datasets/">Datasets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/explainers/">Explainers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/models/">Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/calculators/">Calculators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/types/">Types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api/utils/">Utilities</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">BiasX Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Configuration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="configuration">Configuration</h1>
<p>BiasX uses a configuration system to manage parameters for datasets, models, explainers, and calculators. You can configure the <code>BiasAnalyzer</code> either by passing a Python dictionary directly during instantiation or by loading settings from a configuration file (commonly YAML, though JSON is also supported via utility functions).</p>
<h2 id="configuration-structure">Configuration Structure</h2>
<p>The configuration is typically structured with top-level keys corresponding to the main components: <code>dataset</code>, <code>model</code>, <code>explainer</code>, and <code>calculator</code>.</p>
<pre><code class="language-python"># Example Structure (Python Dictionary)
config = {
    &quot;dataset&quot;: {
        # Dataset parameters...
    },
    &quot;model&quot;: {
        # Model parameters...
    },
    &quot;explainer&quot;: {
        # Explainer parameters...
    },
    &quot;calculator&quot;: {
        # Calculator parameters...
    },
    &quot;analyzer&quot;: { # Optional: Parameters directly for BiasAnalyzer itself
        &quot;batch_size&quot;: 32
    }
}

# Example Instantiation
from biasx import BiasAnalyzer
analyzer = BiasAnalyzer(config=config)

# Example Instantiation from file
analyzer_from_file = BiasAnalyzer.from_file(&quot;path/to/your/config.yaml&quot;) #
</code></pre>
<h2 id="component-configuration-details">Component Configuration Details</h2>
<p>Each component class uses the <code>@configurable</code> decorator, meaning its <code>__init__</code> parameters can be set via the configuration dictionary under the corresponding key (<code>dataset</code>, <code>model</code>, <code>explainer</code>, <code>calculator</code>).</p>
<h3 id="dataset-dataset">Dataset (<code>dataset</code>)</h3>
<p>Parameters for the <code>biasx.datasets.Dataset</code> class.</p>
<ul>
<li><strong><code>source</code></strong>: (Required) The source dataset to use. Should correspond to values in the <code>DatasetSource</code> enum (e.g., <code>"utkface"</code>, <code>"fairface"</code>).</li>
<li><strong><code>image_width</code></strong>: (Required) The target width to resize images to.</li>
<li><strong><code>image_height</code></strong>: (Required) The target height to resize images to.</li>
<li><strong><code>color_mode</code></strong>: (Required) The target color mode. Should correspond to values in the <code>ColorMode</code> enum (e.g., <code>"L"</code> for grayscale, <code>"RGB"</code> for color).</li>
<li><strong><code>max_samples</code></strong>: (Optional) Maximum number of samples to load from the dataset. If <code>0</code> or less, all samples are loaded. Defaults depend on the implementation, but often it's useful to set a smaller number for testing (e.g., <code>100</code>).</li>
<li><strong><code>shuffle</code></strong>: (Optional) Whether to shuffle the dataset before selecting <code>max_samples</code> or iterating. Defaults to <code>False</code>.</li>
<li><strong><code>seed</code></strong>: (Optional) Random seed used for shuffling if <code>shuffle</code> is <code>True</code>. Defaults depend on implementation (e.g., <code>42</code>).</li>
<li><strong><code>batch_size</code></strong>: (Optional) The number of images yielded per iteration when iterating over the dataset. Defaults depend on implementation (e.g., <code>32</code>).</li>
</ul>
<h3 id="model-model">Model (<code>model</code>)</h3>
<p>Parameters for the <code>biasx.models.Model</code> class.</p>
<ul>
<li><strong><code>path</code></strong>: (Required) Filesystem path to the saved Keras/TensorFlow model file (e.g., <code>.h5</code> or a SavedModel directory).</li>
<li><strong><code>inverted_classes</code></strong>: (Required) Boolean indicating if the model's output class indices for Male/Female are inverted compared to the <code>Gender</code> enum (Male=0, Female=1). Set to <code>True</code> if your model predicts Female as 0 and Male as 1.</li>
<li><strong><code>batch_size</code></strong>: (Optional) Batch size used for model prediction (<code>model.predict</code>). Defaults depend on implementation (e.g., <code>64</code>).</li>
</ul>
<h3 id="explainer-explainer">Explainer (<code>explainer</code>)</h3>
<p>Parameters for the <code>biasx.explainers.Explainer</code> class.</p>
<ul>
<li><strong><code>landmarker_source</code></strong>: (Required) Specifies the facial landmark detection model source. Should correspond to values in the <code>LandmarkerSource</code> enum (e.g., <code>"mediapipe"</code>).</li>
<li><strong><code>cam_method</code></strong>: (Required) Specifies the Class Activation Map method to use. Should correspond to values in the <code>CAMMethod</code> enum (e.g., <code>"gradcam"</code>, <code>"gradcam++"</code>, <code>"scorecam"</code>).</li>
<li><strong><code>cutoff_percentile</code></strong>: (Required) Integer percentile (0-100) used to threshold the raw activation map. Pixels below this percentile intensity are set to zero.</li>
<li><strong><code>threshold_method</code></strong>: (Required) Specifies the method used to binarize the thresholded activation map to find distinct activation regions. Should correspond to values in the <code>ThresholdMethod</code> enum (e.g., <code>"otsu"</code>, <code>"sauvola"</code>, <code>"triangle"</code>).</li>
<li><strong><code>overlap_threshold</code></strong>: (Required) Float value (0.0-1.0) determining the minimum overlap area (as a fraction of the activation box area) required to associate an activation box with a landmark box.</li>
<li><strong><code>distance_metric</code></strong>: (Required) Specifies the distance metric used to find the nearest landmark center to an activation center. Should correspond to values in the <code>DistanceMetric</code> enum (e.g., <code>"cityblock"</code>, <code>"cosine"</code>, <code>"euclidean"</code>).</li>
<li><strong><code>batch_size</code></strong>: (Optional) Batch size used during the explanation generation process (specifically for CAM generation). Defaults depend on implementation (e.g., <code>32</code>).</li>
</ul>
<h3 id="calculator-calculator">Calculator (<code>calculator</code>)</h3>
<p>Parameters for the <code>biasx.calculators.Calculator</code> class.</p>
<ul>
<li><strong><code>precision</code></strong>: (Required) Integer specifying the number of decimal places to round calculated bias scores and probabilities to.</li>
</ul>
<h3 id="analyzer-analyzer">Analyzer (<code>analyzer</code>)</h3>
<p>Optional parameters directly for the <code>biasx.analyzer.BiasAnalyzer</code> class itself.</p>
<ul>
<li><strong><code>batch_size</code></strong>: (Optional) Controls the batch size used when iterating through the dataset <em>within</em> the analyzer's main <code>analyze</code> loop. This is distinct from the dataset's own iteration batch size or the model/explainer batch sizes. Defaults depend on implementation (e.g., <code>32</code>).</li>
</ul>
<h2 id="example-configuration-file-configyaml">Example Configuration File (<code>config.yaml</code>)</h2>
<pre><code class="language-yaml"># Dataset Configuration
dataset:
  source: utkface         # Source dataset name (enum value)
  max_samples: 5000      # Max images to load (0 for all)
  shuffle: true          # Shuffle before selecting max_samples
  seed: 42               # Random seed for shuffling
  image_width: 48        # Target image width
  image_height: 48       # Target image height
  color_mode: &quot;L&quot;        # &quot;L&quot; for grayscale, &quot;RGB&quot; for color
  batch_size: 64         # Batch size for dataset iteration

# Model Configuration
model:
  path: &quot;./models/my_face_classifier.h5&quot; # Path to your trained model
  inverted_classes: false              # Does your model output 0=Female, 1=Male?
  batch_size: 128                      # Batch size for model.predict()

# Explainer Configuration
explainer:
  landmarker_source: mediapipe # Source for facial landmarks
  cam_method: gradcam++        # CAM method (gradcam, gradcam++, scorecam)
  cutoff_percentile: 95        # Percentile for CAM heatmap thresholding
  threshold_method: otsu       # Method to binarize heatmap (otsu, sauvola, triangle)
  overlap_threshold: 0.3       # Min overlap to link activation box to landmark
  distance_metric: euclidean   # Metric for nearest landmark (cityblock, cosine, euclidean)
  batch_size: 64               # Batch size for CAM generation

# Calculator Configuration
calculator:
  precision: 4               # Decimal places for calculated scores

# Analyzer Configuration (Optional)
analyzer:
  batch_size: 64             # Batch size for the main analysis loop
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../getting_started/" class="btn btn-neutral float-left" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../api/analyzer/" class="btn btn-neutral float-right" title="Analyzer">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../getting_started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../api/analyzer/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
